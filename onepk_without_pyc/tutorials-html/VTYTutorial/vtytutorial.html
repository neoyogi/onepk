<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Aug 18, 2014
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>onePK Python Tutorials - VTY Service Set Tutorial - Reading RIB routes, updating application routes, adding listeners for route up and down events in the RIB,
and adding listeners for application routes.</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido.min.js"></script>

    
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>onePK Python Tutorials</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://www.cisco.com/go/onepk" id="bannerRight">
                                                                                                <img src="../images/cisco-logo.png" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2014-08-18</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.3.0.181</li>
                      
                
            
      
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
            
                                    <h3>Main</h3>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Home">Home</a>
            </li>
          </ul>
                        <h3>Tutorials</h3>
                  <ul>
                  <li class="none">
                          <a href=".././basetutorial.html" title="Connecting to a Network Element">Connecting to a Network Element</a>
            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li class="expanded">
                          <a href="../index.html#Base_Service_Set_Tutorials" title="Base Service Set Tutorials">Base Service Set Tutorials</a>
                    <ul>
                                                                        <li class="collapsed">
                          <a href="../SessionTutorial/SessionTutorials.html" title="Session Handling">Session Handling</a>
                  </li>
                                                                                                            <li class="collapsed">
                          <a href="../NetworkElement/networkelement.html" title="Element">Element</a>
                  </li>
                                                                                                                                                <li class="collapsed">
                          <a href="../NetworkInterface/networkinterface.html" title="Network Interface">Network Interface</a>
                  </li>
                                                                                                                                                                  <li class="collapsed">
                          <a href="../Events/events.html" title="Events">Events</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Discovery/discovery.html" title="Discovery">Discovery</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Management/management.html" title="Application CLI Extension">Application CLI Extension</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../AAATutorial/AAAOverview.html" title="AAA">AAA</a>
                  </li>
                                                                                  <li class="expanded">
                          <a href="../VTYTutorial/vty.html" title="VTY">VTY</a>
                    <ul>
                      <li class="none">
            <strong>VTY Tutorial</strong>
          </li>
              </ul>
        </li>
                                                                                          <li class="collapsed">
                          <a href="../Policy/policy.html" title="Policy">Policy</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Routing/routing.html" title="Routing">Routing</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../Location/location.html" title="Location">Location</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../Identity/identity.html" title="Identity">Identity</a>
                  </li>
              </ul>
        </li>
          </ul>
                      
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section"><h2><a name="Basic_VTY_Tutorial">Basic VTY Tutorial</a></h2>
<p><a href="https://communities.cisco.com/community/developer/networking/cisco-one/onepk" class="externalLink">For questions, read the onePK Forums</a></p>
<p><b>Contents</b></p>
<ul><li><a href="#Basic_VTY_Tutorial">Basic VTY Tutorial</a></li>
<li><a href="#Goal">Goal</a></li>
<li><a href="#Tutorial_Code">Tutorial Code</a></li>
<li><a href="#RequirementsPrerequisites">Requirements/Prerequisites</a></li>
<li><a href="#Steps_In_Detail">Steps In Detail</a><ul><li><a href="#Create_VTY_Object">Create VTY Object</a></li>
<li><a href="#Open_VTY">Open VTY</a></li>
<li><a href="#Get_VTY_Timeout">Get VTY Timeout</a></li>
<li><a href="#Write_to_VTY">Write to VTY</a></li>
<li><a href="#Get_Parser_State">Get Parser State</a></li>
<li><a href="#Get_VTY_State">Get VTY State</a></li>
<li><a href="#Set_Max_Response_Length">Set Max Response Length</a></li>
<li><a href="#Get_Max_Response_Length">Get Max Response Length</a></li>
<li><a href="#Cancel_Command_Execution">Cancel Command Execution</a></li>
<li><a href="#Close_VTY">Close VTY</a></li>
<li><a href="#Destroy_VTY">Destroy VTY</a></li>
</ul>
</li>
<li><a href="#Result">Result</a></li>
<li><a href="#Next_Steps">Next Steps</a></li>
</ul>
</div>
<div class="section"><h2><a name="Goal">Goal</a></h2>
<p>This tutorial shows you how to open VTY on the network element, how to write a command, read the response, and understand any error codes.</p>
</div>
<div class="section"><h2><a name="Tutorial_Code">Tutorial Code</a></h2>
<p>The code used in this tutorial is available in the VTYTutorial.py file located under &lt;SDK Location&gt;/python/tutorials/src/vty/VTYTutorial.py. </p>
</div>
<div class="section"><h2><a name="RequirementsPrerequisites">Requirements/Prerequisites</a></h2>
<ul><li>These steps assume the application can connect properly to a network element. Please see the <a href="../basetutorial.html">Connecting to a Network Element</a> tutorial for information on how to make the initial connection.</li>
<li>To configure the network element to run the VTY tutorial, you must first enable the VTY Service Set:</li>
</ul>
<div class="source"><pre class="prettyprint">router(config)# onep
router(config-onep)# service set vty</pre>
</div>
</div>
<div class="section"><h2><a name="Steps_In_Detail">Steps In Detail</a></h2>
<div class="section"><h3><a name="Create_VTY_Object">Create VTY Object</a></h3>
<p>First, create the VtyService object.</p>
<div class="source"><pre class="prettyprint">vtyService = VtyService(tutorial.get_network_element()) 
</pre>
</div>
</div>
<div class="section"><h3><a name="Open_VTY">Open VTY</a></h3>
<p>Open VTY on the network element.</p>
<div class="source"><pre class="prettyprint">vtyService.open()
</pre>
</div>
</div>
<div class="section"><h3><a name="Get_VTY_Timeout">Get VTY Timeout</a></h3>
<p>Get a timeout of the VTY on the network element.</p>
<div class="source"><pre class="prettyprint">logger.info(&quot;VTY Time Out - %s&quot;, vtyService.timeout)
</pre>
</div>
</div>
<div class="section"><h3><a name="Write_to_VTY">Write to VTY</a></h3>
<p>Write a string to the VTY on the network element.</p>
<div class="source"><pre class="prettyprint">TEST_CMD1 = &quot;show onep status&quot;;
cli_result = vtyService.write(TEST_CMD1)
logger.info(&quot;Test Command : %s&quot;, TEST_CMD1)
logger.info(&quot;CLI Result for Test Command : %s&quot;, cli_result)
</pre>
</div>
</div>
<div class="section"><h3><a name="Get_Parser_State">Get Parser State</a></h3>
<p>Get the parser state and its attributes on the network element.</p>
<div class="source"><pre class="prettyprint">parser_state = vtyService.get_parser_state()
</pre>
</div>
<div class="source"><pre class="prettyprint">logger.info(&quot;ParserState prompt - %s&quot;, parser_state.prompt)
logger.info(&quot;ParserState overallrc - %s&quot;, parser_state.overallRC)
cmd_results = parser_state.results
for cmd_result in cmd_results:
    logger.info(&quot;ParserState::cmdresult:inputline - %s&quot;, cmd_result.input_line)
    logger.info(&quot;ParserState::cmdresult:parsereturncode - %s&quot;, cmd_result.parse_return_code)
    logger.info(&quot;ParserState::cmdresult:errorlocation - %s&quot;, cmd_result.error_location)
</pre>
</div>
</div>
<div class="section"><h3><a name="Get_VTY_State">Get VTY State</a></h3>
<p>Get the VTY state on the network element. </p>
<div class="source"><pre class="prettyprint">logger.info(&quot;State - %s&quot;, vtyService.state)
</pre>
</div>
</div>
<div class="section"><h3><a name="Set_Max_Response_Length">Set Max Response Length</a></h3>
<p>Set the maximum response length from the network element in bytes. Responses will be truncated to this length. Zero indicates no limit.</p>
<div class="source"><pre class="prettyprint">MAX_RESPONSE_LENGTH = 110
vtyService.max_response = MAX_RESPONSE_LENGTH
logger.info(&quot;MaxResponse - %s&quot;, vtyService.max_response)
</pre>
</div>
</div>
<div class="section"><h3><a name="Get_Max_Response_Length">Get Max Response Length</a></h3>
<p>Get the maximum response length from the network element in bytes. Responses will be truncated to this length. Zero indicates no limit.</p>
<div class="source"><pre class="prettyprint">logger.info(&quot;MaxResponse - %s&quot;, vtyService.max_response)
</pre>
</div>
</div>
<div class="section"><h3><a name="Cancel_Command_Execution">Cancel Command Execution</a></h3>
<p>Cancel the command execution on the network element.</p>
<div class="source"><pre class="prettyprint">vtyService.cancel()
</pre>
</div>
</div>
<div class="section"><h3><a name="Close_VTY">Close VTY</a></h3>
<p>Close the VTY connection on the network element.</p>
<div class="source"><pre class="prettyprint">vtyService.close()
</pre>
</div>
</div>
<div class="section"><h3><a name="Destroy_VTY">Destroy VTY</a></h3>
<p>Destroy the VtyService. This method provides a way for the application to explicitly clean up the VTY resource so that the IDs of the VTY in the network element are returned to the pool when the application has finished using them. Note that this method can only be called after the VTY is closed by the close() method.</p>
<div class="source"><pre class="prettyprint">vtyService.destroy()
</pre>
</div>
</div>
</div>
<div class="section"><h2><a name="Result">Result</a></h2>
<p>Congratulations! You are now able to use your onePK application to create, open, cancel, close VTY and also run commands and check the response. </p>
</div>
<div class="section"><h2><a name="Next_Steps">Next Steps</a> </h2>
<ul><li><a href="../Events/SyslogEventTutorial.html">Syslog Events Tutorial</a></li>
<li><a href="../NetworkInterface/networkinterfacetutorial.html">Accessing Network Interfaces Tutorial</a></li>
<li><a href="../NetworkInterface/interfacestatechangetutorial.html">Interface State Change Tutorial</a></li>
<li><a href="../NetworkInterface/interfacestatisticstutorial.html">Interface Statistics Tutorial</a> </li>
</ul>
</div>

                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2014.
          All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
