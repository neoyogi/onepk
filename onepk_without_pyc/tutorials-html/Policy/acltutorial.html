<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Aug 18, 2014
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>onePK Python Tutorials - onePK Access Control List (ACL) Tutorial - Working with Access Control Lists (ACL) in a Network Element.</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido.min.js"></script>

    
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>onePK Python Tutorials</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://www.cisco.com/go/onepk" id="bannerRight">
                                                                                                <img src="../images/cisco-logo.png" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2014-08-18</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.3.0.181</li>
                      
                
            
      
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
            
                                    <h3>Main</h3>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Home">Home</a>
            </li>
          </ul>
                        <h3>Tutorials</h3>
                  <ul>
                  <li class="none">
                          <a href=".././basetutorial.html" title="Connecting to a Network Element">Connecting to a Network Element</a>
            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li class="expanded">
                          <a href="../index.html#Base_Service_Set_Tutorials" title="Base Service Set Tutorials">Base Service Set Tutorials</a>
                    <ul>
                                                                        <li class="collapsed">
                          <a href="../SessionTutorial/SessionTutorials.html" title="Session Handling">Session Handling</a>
                  </li>
                                                                                                            <li class="collapsed">
                          <a href="../NetworkElement/networkelement.html" title="Element">Element</a>
                  </li>
                                                                                                                                                <li class="collapsed">
                          <a href="../NetworkInterface/networkinterface.html" title="Network Interface">Network Interface</a>
                  </li>
                                                                                                                                                                  <li class="collapsed">
                          <a href="../Events/events.html" title="Events">Events</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Discovery/discovery.html" title="Discovery">Discovery</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Management/management.html" title="Application CLI Extension">Application CLI Extension</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../AAATutorial/AAAOverview.html" title="AAA">AAA</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../VTYTutorial/vty.html" title="VTY">VTY</a>
                  </li>
                                                                                                    <li class="expanded">
                          <a href="../Policy/policy.html" title="Policy">Policy</a>
                    <ul>
                      <li class="none">
            <strong>Basic ACL Tutorial</strong>
          </li>
                      <li class="none">
                          <a href="../Policy/bulkqospolicy.html" title="Basic QOS Tutorial">Basic QOS Tutorial</a>
            </li>
              </ul>
        </li>
                                                                                          <li class="collapsed">
                          <a href="../Routing/routing.html" title="Routing">Routing</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../Location/location.html" title="Location">Location</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../Identity/identity.html" title="Identity">Identity</a>
                  </li>
              </ul>
        </li>
          </ul>
                      
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section"><h2><a name="Basic_ACL_Tutorial">Basic ACL Tutorial</a></h2>
<p><a href="https://communities.cisco.com/community/developer/networking/cisco-one/onepk" class="externalLink">For questions, read the onePK Forums</a></p>
<p><b>Contents</b></p>
<ul><li><a href="#Basic_ACL_Tutorial">Basic ACL Tutorial</a></li>
<li><a href="#Goal">Goal</a></li>
<li><a href="#Tutorial_Code">Tutorial Code</a></li>
<li><a href="#RequirementsPrerequisites">Requirements/Prerequisites</a></li>
<li><a href="#Steps_in_Detail">Steps in Detail</a><ul><li><a href="#Create_an_Access_Control_List">Create an Access Control List</a></li>
<li><a href="#Create_an_Access_Control_Element">Create an Access Control Element</a></li>
<li><a href="#Apply_an_Access_Control_Element">Apply an Access Control Element</a></li>
<li><a href="#Remove_an_Access_Control_Element">Remove an Access Control Element</a></li>
</ul>
</li>
<li><a href="#Result">Result</a></li>
<li><a href="#Next_Steps">Next Steps</a></li>
</ul>
</div>
<div class="section"><h2><a name="Goal">Goal</a></h2>
<p>This tutorial shows how a onePK application can create an Access Control List (ACL) in a network element. It also shows how to create and add an Access Control Element (ACE) to the list. The ACL is added to an Interface on the network element. The onePK application can retrieve the match counts for each ACE. </p>
</div>
<div class="section"><h2><a name="Tutorial_Code">Tutorial Code</a></h2>
<p>The code used in this tutorial is available in available in the ACLTutorial.py file located under &lt;SDK Location&gt;/python/tutorials/Policy.</p>
</div>
<div class="section"><h2><a name="RequirementsPrerequisites">Requirements/Prerequisites</a></h2>
<p>To register for application events from a network element, the application must already know the following information:</p>
<ul><li>Know how to connect an application to a onePK-enabled network element. See <a href="../basetutorial.html">Connecting to a Network Element</a> tutorial.</li>
</ul>
</div>
<div class="section"><h2><a name="Steps_in_Detail">Steps in Detail</a></h2>
<div class="section"><h3><a name="Create_an_Access_Control_List">Create an Access Control List</a></h3>
<p>Create the ACL on the network element. As these functions are invoked, the ACLs are created on the network element. There are several types of ACL: L3 IPv4 ACL, L3 IPv6 ACL and L2 MAC ACL. </p>
<div class="source"><pre class="prettyprint">#  Create a L3 IPv4 Access Control List
l3_acl = L3Acl(networkElement, OnepConstants.OnepAddressFamilyType.ONEP_AF_INET, 0)
</pre>
</div>
</div>
<div class="section"><h3><a name="Create_an_Access_Control_Element">Create an Access Control Element</a></h3>
<p>Create an L3 IPv4 ACE. We will set the protocol to TCP. Specify source and destination prefixes and prefix lengths. For port matches the protocol must be TCP, UDP or SCTP. Set a source port and a destination port range. Also specify the TCP flags and matching criteria. Specify any SysLog flags.</p>
<div class="source"><pre class="prettyprint"># Creates a new Access Control Element w/ Sequence Number 10 and this will &quot;permit&quot; the following conditions.
l3_ace = L3Ace(tutorial.SEQUENCE_NUMBER, True)
# Protocol value must be a number between 0 and 256.
# 256 = All protocols   6 =  TCP
l3_ace.protocol = 6

value = [l3_ace.TcpFlags.ONEP_TCP_URG, 
             l3_ace.TcpFlags.ONEP_TCP_SYN]
mask  = [l3_ace.TcpFlags.ONEP_TCP_FIN, 
         l3_ace.TcpFlags.ONEP_TCP_SYN, 
         l3_ace.TcpFlags.ONEP_TCP_PSH, 
         l3_ace.TcpFlags.ONEP_TCP_ACK]
match = l3_ace.TcpFlagMatch.ONEP_MATCH_ALL  

l3_ace.set_tcp_flags(value, mask, match)
# Permit any source prefix
l3_ace.set_src_prefix_any()
# Permit any destination prefix
l3_ace.set_dst_prefix_any()            
# Set the value of the DSCP field        
l3_ace.set_dscp(OnepConstants.OnepDscp.ONEP_DSCP_CS1)
# Log the Access Control Element    
l3_ace.set_log_flag(l3_ace.log_flag.ONEP_ACL_LOG_NORMAL)
</pre>
</div>
</div>
<div class="section"><h3><a name="Apply_an_Access_Control_Element">Apply an Access Control Element</a></h3>
<p>Now add the L3 ACE to the ACL. After the ACE is added to the ACL we will apply the ACL to an Interface. As these functions are invoked the ACEs are added to the connected network element.</p>
<div class="source"><pre class="prettyprint">#  Add Access Control Element to Access Control List
l3_acl.add_ace(l3_ace)
</pre>
</div>
<div class="source"><pre class="prettyprint">l3_acl.apply_to_interface(tutorial.network_interface, Acl.Direction.ONEP_DIRECTION_IN)
</pre>
</div>
<p>After this ACL is applied you can also go to the network element and run a few commands to ensure it is in place. Run the following commands to display information about the applied ACL:</p>
<ul><li>show ip access-list dynamic</li>
<li>show ip interface &lt;interface name&gt; | include access list </li>
</ul>
</div>
<div class="section"><h3><a name="Remove_an_Access_Control_Element">Remove an Access Control Element</a></h3>
<p>Finally, we can easily remove the Access Control Element that we have applied.</p>
<div class="source"><pre class="prettyprint">#  Remove Access Control Element from ACL.
l3_acl.remove_ace(l3_ace)
#  Remove ACL from interface. 
l3_acl.delete_acl()
</pre>
</div>
</div>
</div>
<div class="section"><h2><a name="Result">Result</a></h2>
<p>Congratulations! You have applied an Access Control Element to an access control list, and applied the access control list to an interface on a network element.</p>
</div>
<div class="section"><h2><a name="Next_Steps">Next Steps</a> </h2>
<ul><li><a href="../Events/SyslogEventTutorial.html">Syslog Events Tutorial</a></li>
<li><a href="../NetworkInterface/networkinterfacetutorial.html">Basic Network Interfaces Tutorial</a></li>
<li><a href="../NetworkInterface/interfaceaddresstutorial.html">Interface Address Tutorial</a></li>
<li><a href="../NetworkInterface/interfacestatechangetutorial.html">Interface State Change Tutorial</a></li>
<li><a href="../NetworkInterface/interfacestatisticstutorial.html">Interface Statistics Tutorial</a> </li>
</ul>
</div>

                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2014.
          All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
