<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Aug 18, 2014
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>onePK Python Tutorials - Application CLI Extension Tutorial - Working with Managed Data in a Network Element</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido.min.js"></script>

    
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>onePK Python Tutorials</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://www.cisco.com/go/onepk" id="bannerRight">
                                                                                                <img src="../images/cisco-logo.png" />
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2014-08-18</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.3.0.181</li>
                      
                
            
      
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
            
                                    <h3>Main</h3>
                  <ul>
                  <li class="none">
                          <a href="../index.html" title="Home">Home</a>
            </li>
          </ul>
                        <h3>Tutorials</h3>
                  <ul>
                  <li class="none">
                          <a href=".././basetutorial.html" title="Connecting to a Network Element">Connecting to a Network Element</a>
            </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li class="expanded">
                          <a href="../index.html#Base_Service_Set_Tutorials" title="Base Service Set Tutorials">Base Service Set Tutorials</a>
                    <ul>
                                                                        <li class="collapsed">
                          <a href="../SessionTutorial/SessionTutorials.html" title="Session Handling">Session Handling</a>
                  </li>
                                                                                                            <li class="collapsed">
                          <a href="../NetworkElement/networkelement.html" title="Element">Element</a>
                  </li>
                                                                                                                                                <li class="collapsed">
                          <a href="../NetworkInterface/networkinterface.html" title="Network Interface">Network Interface</a>
                  </li>
                                                                                                                                                                  <li class="collapsed">
                          <a href="../Events/events.html" title="Events">Events</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Discovery/discovery.html" title="Discovery">Discovery</a>
                  </li>
                                                                                                    <li class="expanded">
                          <a href="../Management/management.html" title="Application CLI Extension">Application CLI Extension</a>
                    <ul>
                      <li class="none">
                          <a href="../Management/applicationconfigurationtutorial.html" title="Application CLI Extension Configuration Tutorial">Application CLI Extension Configuration Tutorial</a>
            </li>
                      <li class="none">
            <strong>Application CLI Extension Tutorial</strong>
          </li>
              </ul>
        </li>
                                                                                          <li class="collapsed">
                          <a href="../AAATutorial/AAAOverview.html" title="AAA">AAA</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../VTYTutorial/vty.html" title="VTY">VTY</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Policy/policy.html" title="Policy">Policy</a>
                  </li>
                                                                                          <li class="collapsed">
                          <a href="../Routing/routing.html" title="Routing">Routing</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../Location/location.html" title="Location">Location</a>
                  </li>
                                                                        <li class="collapsed">
                          <a href="../Identity/identity.html" title="Identity">Identity</a>
                  </li>
              </ul>
        </li>
          </ul>
                      
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <div class="section"><h2><a name="Basic_Application_CLI_Extension_Tutorial">Basic Application CLI Extension Tutorial</a></h2>
<p><a href="http://developer.cisco.com/web/onepk/community" class="externalLink">For questions, read the onePK Forums</a></p>
<p><b>Contents</b></p>
<ul><li><a href="#Basic_Application_CLI_Extension_Tutorial">Basic Application CLI Extension Tutorial</a></li>
<li><a href="#Goal">Goal</a></li>
<li><a href="#Tutorial_Code">Tutorial Code</a></li>
<li><a href="#RequirementsPrerequisites">Requirements/Prerequisites</a></li>
<li><a href="#Steps_In_Detail">Steps In Detail</a><ul><li><a href="#Creating_an_Application_Instance">Creating an Application Instance</a></li>
<li><a href="#Listening_for_Custom_Configuration_Commands">Listening for Custom Configuration Commands</a></li>
<li><a href="#Listening_for_Custom_Exec_Commands">Listening for Custom Exec Commands</a></li>
<li><a href="#Retrieving_Configuration_Information">Retrieving Configuration Information</a></li>
<li><a href="#Register_Custom_Command_Listeners">Register Custom Command Listeners</a></li>
</ul>
</li>
<li><a href="#Result">Result</a></li>
<li><a href="#Next_Steps">Next Steps</a></li>
</ul>
</div>
<div class="section"><h2><a name="Goal">Goal</a></h2>
<p>This tutorial shows how the Application CLI Extension service enables a onePK application to add commands to the network element's command-line-based management interface (CLI), which can then be used to configure the application from the network element. In addition, it describes how to install listener callbacks into the onePK application and how to respond to show command requests.</p>
</div>
<div class="section"><h2><a name="Tutorial_Code">Tutorial Code</a></h2>
<p>The code used in this tutorial is available in the ApplicationManagementTutorial.py file located under &lt;SDK Location&gt;/python/tutorials/applmgmt.</p>
<p>The XML containing the custom CLI is available located under &lt;SDK Location&gt;/python/tutorials/applmgmt/cli_ext_tutorial_app.xml.</p>
</div>
<div class="section"><h2><a name="RequirementsPrerequisites">Requirements/Prerequisites</a></h2>
<p>These steps assume </p>
<ul><li>The application can connect properly to a network element. Please see the <a href="../basetutorial.html">Connecting to a Network Element</a> tutorial for information on how to make the initial connection.</li>
<li>You have successfully installed an application-specific XSD file on the network element. Please see <a href="./applicationconfigurationtutorial.html"> Application CLI Extension Configuration Tutorial</a> for details.</li>
</ul>
</div>
<div class="section"><h2><a name="Steps_In_Detail">Steps In Detail</a></h2>
<p>Once you have installed the XSD file into the network element CLI tree, you can write your application to retrieve application configuration data and handle configuration and EXEC events.</p>
<div class="section"><h3><a name="Creating_an_Application_Instance">Creating an Application Instance</a></h3>
<p>First you should begin by creating an ApplicationCLI instance.</p>
<div class="source"><pre class="prettyprint">'''
 Note that the application name has to match the name in xml file.
 In this case, in cli_ext_tutorial_app.xml, its name 'cli_tutorial_app'.
'''    
if not tutorial.connect(tutorial.app_name):
    sys.exit(2)
    
</pre>
</div>
</div>
<div class="section"><h3><a name="Listening_for_Custom_Configuration_Commands">Listening for Custom Configuration Commands</a></h3>
<p>Then create an ApplicationConfigCLIListener to listen for the example custom commands that you added to the device. This listener triggers each time a custom configuration command is executed on the onePK-enabled device.</p>
<div class="source"><pre class="prettyprint">class ExampleConfigListener(ApplicationConfigCliListener):
        
    def handle_event(self, cli_data, client_data):
            
        cli_data_name = cli_data.data_name
        cli_data_value = cli_data.data_value
        print &quot;\ndataName = &quot; + cli_data_name + &quot;, dataValue = &quot; + cli_data_value + &quot;, clientData = &quot; + client_data

</pre>
</div>
</div>
<div class="section"><h3><a name="Listening_for_Custom_Exec_Commands">Listening for Custom Exec Commands</a></h3>
<p>Next create another listener that listens to EXEC commands on the onePK-enabled device. Once again, this listener triggers each time a custom EXEC command is executed on the device.</p>
<div class="source"><pre class="prettyprint">class ExampleExecListener(ApplicationExecCliListener):
        
    def handle_event(self, cli_data, client_data):
            
        cli_data_name = cli_data.data_name
        print &quot;\ndataName = &quot; + cli_data_name + &quot;, clientData = &quot; + client_data
        return &quot;PythonClient data&quot;

</pre>
</div>
</div>
<div class="section"><h3><a name="Retrieving_Configuration_Information">Retrieving Configuration Information</a></h3>
<p>You can retrieve your current configuration information of the connected device by using the following API:</p>
<div class="source"><pre class="prettyprint"># Retrieve config value for App config data 'app-category' 

application_cli = ApplicationCli(tutorial.get_network_element(),
                                 tutorial.version,
                                 tutorial.instance,
                                 tutorial.domain )
config_data = application_cli.get_config('app_category_cmd')
</pre>
</div>
</div>
<div class="section"><h3><a name="Register_Custom_Command_Listeners">Register Custom Command Listeners</a></h3>
<p>You can then register the example listeners that you have created to your onePK-enabled device.</p>
<div class="source"><pre class="prettyprint">#  Add execListener and configListener 
application_cli.set_exec_listener(ExampleExecListener(), &quot;Show data changed&quot;)
application_cli.set_config_listener(ExampleConfigListener(), &quot;Config data changed&quot;)
</pre>
</div>
</div>
</div>
<div class="section"><h2><a name="Result">Result</a></h2>
<p>Congratulations! Now you should be able to create custom commands and listen for them on the network element.</p>
<p>Try out this tutorial code by compiling and running it. You can find the code located at: &lt;SDK Location&gt;/python/tutorials/applmgmt/ApplicationManagementTutorial.py.</p>
</div>
<div class="section"><h2><a name="Next_Steps">Next Steps</a> </h2>
<ul><li><a href="../Topology/topology.html">Topology</a></li>
<li><a href="../Policy/policy.html">Policy</a></li>
<li><a href="../Routing/routing.html">Routing</a></li>
<li><a href="../VTYTutorial/vty.html">VTY</a> </li>
</ul>
</div>

                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2014.
          All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
